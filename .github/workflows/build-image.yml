---
  name: "Build Image"
  on:
    workflow_call:
      secrets:
        SIGNING_SECRET:
          required: true
        
      inputs:
        hyprland_build:
          default: "fedora"
          type: string
        version:
          type: number
          required: true
        virtualization:
          type: string
          default: "no"
  
  jobs:
    set_image_name:
      name: "Set image name"
      uses: "./.github/workflows/set-image-name.yml"
      with:
        hyprland_build: ${{ inputs.hyprland_build }}
        version: ${{ inputs.version }}
      
    build:
      name: "Build Image"
      uses: ./.github/workflows/image.yml
      needs: set_image_name
      with:
        image_name: "${{ needs.set_image_name.outputs.image_name }}"
        image_desc: "Hyprland Shell Blue Image ${{ inputs.hyprland_build }}"
        image_registry: "ghcr.io/${{ github.repository_owner }}"
        hyprland_build: ${{ inputs.hyprland_build }}
        source_tag: ${{ inputs.version }}
        virtualization: ${{ inputs.virtualization }}
      secrets:
        SIGNING_SECRET: ${{ secrets.SIGNING_SECRET }}